/*! appverse-web-html5-core - v0.5.0-dev - */
!function(){"use strict";function a(a){a.info("appverse.performance run")}angular.module("appverse.performance",["appverse.configuration"]).run(a),a.$inject=["$log"]}(),function(){"use strict";angular.module("appverse.performance").directive("webworker",["$log","WebWorkerFactory","PERFORMANCE_CONFIG",function(a,b,c){return{restrict:"E",scope:{workerid:"@",message:"@",template:"@"},priority:1e3,terminal:!0,compile:function(){},link:function(d,e,f){function g(a){d.workerid=j,d.template=k||c.webworker_Message_template,h(d.workerid,a)}function h(a,c){b.runTask(a,c);var e=b._resultMessage;e&&(d.messageFromWorker=e)}function i(a,b,c){a.get(d.template,{cache:b}).success(function(a){e.html(a),c(e.contents())(d)})}var j=f.id,k=f.template;d.$watch(function(){return b._resultMessage},function(c){a.debug("Cache watch {"+name+"}:",c),d.messageFromWorker=b._resultMessage}),d.$watch("message",function(a){g(a),i()})}}}])}(),function(){"use strict";function a(a,b,c){function d(b){var d=this;this.parentPool=b,this.workerTask={},this.run=function(b){if(d.workerTask=b,null!=d.workerTask.script){var e;b.type==c.webworker_dedicated_literal?(e=new Worker(d.workerTask.script),e.addEventListener("message",d.OnWorkerMessageHandler,!1),e.postMessage(d.workerTask.startMessage)):b.type==c.webworker_shared_literal?(e=new SharedWorker(d.workerTask.script),e.port.addEventListener("message",d.OnWorkerMessageHandler,!1),e.port.postMessage(d.workerTask.startMessage)):a.error("NO VALID WORKER TYPE")}},d.OnWorkerMessageHandler=function(a){d.workerTask.callback(a),d.parentPool.freeWorkerThread(d)}}function e(a){g._resultMessage=a.data}function f(a,b,c,d){this.id=a,this.type=b,this.poolSize=c,this.file=d}var g={_poolSize:c.webworker_pooled_threads,_authorizedWorkersOnly:c.webworker_authorized_workers_only,_workersDir:c.webworker_directory,_workersList:c.webworker_authorized_workers,_resultMessage:""};return a.debug("Initializated webworkers factory preconfigured values."),a.debug("Default pool size: "+g._poolSize),a.debug("Are only authorized preconfigured workers? "+g._authorizedWorkersOnly),a.debug("The folder for webworkers in the app: "+g._workersDir),a.debug("Number of members in the workers list: "+g._workersList.length),g.runParallelTasksGroup=function(b,c){this.workerData=b,a.debug("Started parallelized execution for worker: "),a.debug(b.toString());var d=new g.WorkerPool(this.workerData.poolSize);if(d.init(),c&&c.length>0)for(var e=0;e<c.length;e++){var f=c[e];d.addWorkerTask(f)}return g._resultMessage},g.runTask=function(b,c,d){var e=new g.WorkerPool(g._poolSize);e.init();var h,i;if(g._authorizedWorkersOnly?b?h=g.getWorkerFromId(b):a.error("NO VALID WORKER ID ERROR"):b?h=new f(1001,"dedicated",b):a.error("NO VALID WORKER ID ERROR"),h){e=new g.WorkerPool(h.poolSize),i=new g.WorkerTask(h,d,c);for(var j=0;j<g._poolSize;j++)e.addWorkerTask(i)}else a.error("NO WORKER DATA ERROR")},g.WorkerPool=function(a){var b=this;this.size=a?a:g._poolSize,this.taskQueue=[],this.workerQueue=[],this.init=function(){for(var a=0;a<b.size;a++)b.workerQueue.push(new d(b))},this.addWorkerTask=function(a){if(b.workerQueue.length>0){var c=b.workerQueue.shift();c.run(a)}else b.taskQueue.push(a)},this.freeWorkerThread=function(a){if(b.taskQueue.length>0){var c=b.taskQueue.shift();a.run(c)}else b.taskQueue.push(a)}},g.WorkerTask=function(a,b,c){this.script=a.file,this.callback=b?b:e,this.startMessage=c,this.type=a.type},f.prototype.toString=function(){return"ID: "+this.id+"|TYPE: "+this.type+"|POOL SIZE: "+this.poolSize+"|FILE: "+this.file},g.getWorkerFromId=function(a,b){this.id=a,this.type="",this.poolSize=b,this.file="";for(var c=0;c<g._workersList.length;c++)if(g._workersList[c].id===a){this.type=g._workersList[c].type,this.poolSize=this.poolSize&&0!=this.poolSize?b:g._workersList[c].poolSize,this.file=g._workersDir+g._workersList[c].file;break}var d=new f(this.id,this.type,this.poolSize,this.file);return d},g}angular.module("appverse.performance").factory("WebWorkerPoolFactory",a),a.$inject=["$log","$q","PERFORMANCE_CONFIG"]}();
//# sourceMappingURL=appverse-performance.min.js.map